# 拓展屏检测



突发奇想，可以由如下方案实现



## C语言

可以直接编程exe，让考生运行截图，才开始考试



真正的只有提示框的代码：

```c
#include <windows.h>
#include <stdio.h>

int WINAPI WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd) {
    // 获取显示器信息
    DEVMODE devMode;
    EnumDisplaySettings(NULL, ENUM_CURRENT_SETTINGS, &devMode);

    // 获取连接的显示器数量
    DISPLAY_DEVICE dd;
    int displayCount = 0;
    ZeroMemory(&dd, sizeof(dd));  // 初始化结构体，只需要调用一次
    dd.cb = sizeof(dd);

    // 枚举显示设备，检查显示器数量
    while (EnumDisplayDevices(NULL, displayCount, &dd, 0)) {
        displayCount++;
    }

    // 判断是否有拓展屏
    if (displayCount > 1) {
        MessageBoxW(NULL, L"有拓展屏", L"显示器信息", MB_OK | MB_ICONINFORMATION); // 使用 MessageBoxW
    } else {
        MessageBoxW(NULL, L"没有拓展屏", L"显示器信息", MB_OK | MB_ICONINFORMATION); // 使用 MessageBoxW
    }

    return 0;
}
```



devcpp编译的时候加上选项`-mwindows`

```
gcc -o check_display.exe check_display.c -lgdi32
```







## Python语言

安装包：

```
pip install pygetwindow screeninfo
```



代码：

```python
import pygetwindow as gw
from screeninfo import get_monitors

def check_external_display():
    # 获取连接的显示器数量
    monitors = get_monitors()
    
    if len(monitors) > 1:
        print("有拓展屏")
    else:
        print("没有拓展屏")

if __name__ == "__main__":
    check_external_display()
```



同理的，python也是有方法搞成exe

