# 蜜罐

参考资料：

[攻防演练中红队如何识别蜜罐保护自己 - FreeBuf网络安全行业门户](https://www.freebuf.com/articles/network/236485.html)

[红队必备：WEB蜜罐识别阻断插件 - FreeBuf网络安全行业门户](https://www.freebuf.com/articles/web/246938.html)

[防守实战-蜜罐反制之攻击链还原 - FreeBuf网络安全行业门户](https://www.freebuf.com/defense/379601.html)





蓝队

主动防御

溯源

设置诱饵来引诱攻击者进行攻击，从而对攻击行为进行捕获和分析





## 定义



- 低交互式蜜罐 ：通常是指与操作系统交互程度较低的蜜罐系统，仅开放一些简单的服务或端口，用来检测扫描和连接，这种容易被识别。

- 中交互式蜜罐 ：介于低交互式和高交互式之间，能够模拟操作系统更多的服务，让攻击者看起来更像一个真实的业务，从而对它发动攻击，这样蜜罐就能获取到更多有价值的信息。

- 高交互式 ：指的是与操作系统交互很高的蜜罐，它会提供一个更真实的环境，这样更容易吸引入侵者，有利于掌握新的攻击手法和类型，但同样也会存在隐患，会对真实网络造成攻击。



无交互蜜罐：通常释放大量指纹诱导扫描器进行攻击

低交互蜜罐：像HFish，这种的就是低交互，释放端口并且有一些简单的服务

高交互蜜罐：在一些真实环境安插探针，保持原有业务功能的情况下，获取攻击者信息



## 蓝队防护

​	直接安装，部署，查询日志，每天守岗就可以了



## 红队识别

比较容易识别的就是低交互蜜罐



一般使用虚拟文件系统和注册表的信息、内存分配特征、硬件特征、特殊指令等进行识别



```
1. BOF的识别；BOF（Back Officer Friendly）

2. 假代理技术，关注Honeypot Hunter软件；

3. Honeyd的识别；

4. 利用Sebek识别蜜网，第二、三代蜜网都有这个软件；

5. Tarpits的识别；

6. 外联数据控制识别，一般蜜罐会严格限制系统向外的流量；

7. 识别VMware虚拟机，重点关注MAC地址的范围

8. 用Nmap等Scan工具，同一个机器同时开放很多Port的。

9. 因为很多蜜罐都设置在相同或临近的网段。所以，同一个网段（e.g. ／24），很多机器都开放相同的Port，回应相似的Response。

10. 去Shodan／Censys查
```



### web插件简单识别

https://github.com/cnrstar/anti-honeypot

这类可以识别当前网站是否是蜜罐，并且弹窗警告

二是对访问的jsonp接口进行充值，防止对方获取到真实ID







### 规避蜜罐：

- 虚拟机进行攻击，并且做好隔离
- 系统测试不要暴露个人敏感信息
- 使用云函数、CDN、域前置等手段防止溯源
- 识别蜜罐特征，发现蜜罐后==立刻重启虚拟机或恢复快照==
- 社工用小号



















## Hfish

官网：[反制溯源_欺骗防御_主动防御-HFish免费蜜罐平台](https://hfish.net/#/)

​	HFish支持基本网络 服务、OA系统、CRM系统、NAS存储系统、Web服务器、运维平台、安全产品、无线AP、交换机/路由器、邮件系统、IoT设备等90多种蜜罐服务、

​	B/S架构

