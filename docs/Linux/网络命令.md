# Linux中常用的网络命令

## 1.设置网络参数

- ifconfig：查询设置网卡与IP网络等相关参数；
- ifup，ifdown：本质是script文件，启动与关闭网络接口，仅能支配/etc/sysconfig/network-scripts内设置的ifcfg-ethX；
- route：查看配置路由表；
- ip：整合式命令，直接修改上述提到的功能；

## 2.ifconfig

### 1.作用：

手动启动、查看与修改网络接口的相关参数，包括IP参数以及MTU等；

### 2.语法：

#### 1.基础语法：

```shell
ifconfig {interface} {options}
//通常都是eth0以及你的网卡wlan0，可以通过这个启动和关闭
//可以看到指定网络接口的参数
```

其中options有以下参数：

- up，down：启动或关闭该网络接口；
- mtu：设置不同的MTU数值，例如mtu 1500 ，单位是byte；
- netmask：子网掩码；
- broadcast：广播地址；

#### 2.常用及含义：

一般我们都是直接ifconfig一条显示出全部来：那么上面到底说了什么信息呢？

- eth0：网卡的名称代号，也有loopback；
- HWaddr：网卡MAC地址；
- inet addr：IPv4的IP地址；
- inet6 addr：IPv6的IP地址；
- MTU：网络接口的最大传输单位；
- RX：数据包接收，packets代表数据包数量，errors代表数据包错误数量，dropped代表数据包有问题而丢失的数量；
- TX：与RX相反，为数据包发送情况；
- collisions：数据包冲突情况；
- txqueuelen：传输数据的缓冲区的存储长度；
- RX bytes，TX bytes：接受，发送字节总量

#### 3.命令场景使用：

##### 1.暂时修改网络接口：

```shell
ifconfig eth0 192.168.12.12
//若其余不加参数，它会自动分配IP参数
//若是想自定义，则：
ifconfig eth0 ip netmask 子网掩码 mtu 数值
//当用到的时候就知道多需要了！

//当然你也可以单独设置某一个值，直接在eth0后面加参数就行了！
ifconfig eth0 mtu 1000
```

##### 2.伪造IP：

```shell
ifconfig eth0:0 192.168.50.50
//可以在实体网卡上仿真一个网络接口，可以设置多个IP，虚拟机有大用！
ifconfig eth0:0 down
//当然你也可以这样关掉这个东西！
```

##### 3.重置网络

```shell
/etc/init.d/network restart
//没事多试试这个，有大用！
```

## 3.ifup、ifdown

这个没啥好说的，用来启动或关闭网络接口，但需要注意的是 **这只能开启或关闭未设置或未修改的网络接口！！**

```shell
ifup {interface}
//开启
ifdown {interface}
//关闭
```

## 4.route

这个命令是用来修改路由的，那么什么是路由？简单来说，你只要知道两台主机之间一定要有路由才能够互通TCP/IP协议，否则就无法进行连接。

### 1.用法

#### 1.入门用法：

```shell
route [-nee]
//有没有-n其实影响不大，defaults与0.0.0.0的区别，-ee是显示更加详细的信息
//一般都是route -nee 直接使用
```

#### 2.基础用法：

```shell
route add [-net|-host] [网络或主机] netmask [mask] [gw|dev]
route del [-net|-host] [网络或主机] netmask [mask] [gw|dev]
//以上就是增加以及删除相关路由设置了
//我们要了解几个点：
//-net：表示后面接的路由为一个网络
//-host：表示后面接的为连接到单部主机的路由
//netmask：决定网络大小
//gw：gateway的简写，后续接的是IP的数值
//dev：只是要指定网卡发出就用这条设置，后面接eth0等，与gw不同！！
```

### 2.常用及含义：

当你使用route命令时，命令行中会出现一大坨东西，那同样我们也要了解它是什么东西：

- Destination、Genmask：分别是network与netmask，二者组成完整的网络；
- Gateway：显示该网络由哪个gateway发出的，0.0.0.0本机发送，IP经过路由器发送；
- Flags：
  - U（route is up）：该路由是启动的；
  - H（target is a host）：目标是一台主机IP而非网络；
  - G（use gateway）：需要通过外部的主机来传递数据包；
  - R（reinstate route for dynamic routing）：使用动态路由时，恢复路由信息的标志；
  - D（dynamicallt installed by daemon or redirect）：动态路由；
  - M（modified from routing daemon or redirect）：路由已被修改；
  - !（reject route）：这个路由将不会被接受（用来阻止不安全的网络）；

- Iface：这个路由传递数据包的接口

  **路由是有顺序的！**

  **小网络（C类）-->大网络（B类）-->默认路由（0.0.0.0）**

## 5. ip

这个ip可不是你以为的那个ip，它其实综合了route和ifconfig的功能

### 1.用法

```shell
ip [options] [动作] [命令]

//options：-s：显示出设备的统计数据；

//动作：
link：与设备相关的设置，MTU与MAC地址等
addr/address：关于额外的IP协议，多IP的实现
route：与路由有关的相关设置
```

#### 1.ip link

ip link可以设置与设备有关的相关参数，包括MTU以及网络接口的MAC等，当然也可以启动（up）或者关闭（down）某个网络接口。相当于ifconfig与ifup，ifdown的综合用法！（与OSI中第二层数据链路层有关）

```shell
ip [-s] link show
//单纯查看该设备的相关信息
ip link set [参数]
//配置相关参数的使用
//参数可以有：
up|down , address , name , mtu
//用法和上面的ifconfig相同，就不浪费时间了，值得注意的是使用ifconfig无法更改网卡名称，而使用ip可以更改
```

#### 2.ip address

ip address设置与IP有关的各项参数，包括netmask、broadcast等；（与OSI中第三层网络层有关）

```shell
ip address show 
//查看IP参数
ip address [add|del] [IP参数] [dev设备名称] [相关参数]
```

前面与ifconfig都类似，这里讲一下相关参数都有什么：

dev：这个IP参数所要设置的接口，如eth0，参数如下：

- broadcast：设置广播地址，如果设置值为+，则表示系统自动分配；
- label：这个设备的别名，例如eth0:0；
- scope：这个选项的参数又分为：
  - global：允许来自所有来源的连接；
  - site：仅允许IPv6，仅允许本主机的连接；
  - link：仅允许本设备自我连接；
  -  host：仅允许本主机内部的连接；
  - 默认为global设置；

常见用法：

```shell
ip address add 192.168.50.50/24 broadcast + dev eth0 label eth0:vbird
//添加一个虚拟的网络接口！
然后可以用ip address show来查看操作结果；
ip address del 192.168.50.50/24 dev eth0
//删除设置
```

#### 3.ip route

关于路由的相关设置，与route类似，但是它可以进行额外的参数设计，如MTU的规划，功能相当强大！

```shell
ip route show
//show可以用list代替
//老样子，查看路由设置
ip route [add|del] [IP或者是网络号] [via gateway] [dev设备]

```

其中相关各参数含义：

- IP或网络号：可使用/24之类的网络号或是单纯的IP地址；
- via：从哪个gateway出去；
- dev：由哪个设备出去；
- mtu：额外设置MTU的数值；

信息参数：

- proto：路由协议，kernel指的是直接由内核判断自主设定
- scope：路由范围，主要是link，与本设备有关的直接连接

##### 1.路由的删除与添加：

```shell
ip route add 192.168.50.50/24 dev eth0
//添加本机直接可沟通的网络

ip route add 192.168.10.10/24 via 192.168.5.100 dev eth0
//增加可以通往外部的路由，需要通过router

删除方法改一下动作就行了
```



